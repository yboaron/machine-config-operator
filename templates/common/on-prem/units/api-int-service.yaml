name: api-int.service
# This service is run by a timer
enabled: false
contents: |
  [Unit]
  Description=Ensure api-int entry exists in /etc/hosts
  Before=kubelet.service crio.service

  [Service]
  Type=oneshot
  ExecStart=/bin/bash -c "grep -q -e '{{ onPremPlatformAPIServerInternalIP . }} api-int api-int.{{ .DNS.Spec.BaseDomain }}' -F /etc/hosts || echo '{{ onPremPlatformAPIServerInternalIP . }} api-int api-int.{{ .DNS.Spec.BaseDomain }}' >> /etc/hosts"
